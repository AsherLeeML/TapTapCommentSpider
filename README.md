# TapTapCommentSpider

简历内容太贫乏怎么办啊？紧赶慢赶写个小项目吧。

这是其中一个组件，用来爬 TapTap 排行榜上当前的 TOP30 的玩家评论。本来打算速战速决一天解决，requests + BeautifulSoup 完成基本功能已经完全够了，但怕数据的速度实在太慢了就考虑加多线程和异步，谁想到越做越乱套……

https://github.com/joye1230/taptap-reptile

其实一开始打算直接上 Scrapy，正巧已经有人写过了一个很简单的例子，结果拿来一跑爬不到东西，看返回是被 Aliyun 给 405 了。明明只是半年前的代码，你们升级倒挺快……

加代理池之类的应该可以解决，然鹅我是完全新手加代码弱鸡没这个时间和精力。于是打算直接加个异步得了，最慢也不过是爬个一两天嘛。

`aiohttp` 可以用来写异步，小数据测试没问题，速度大概有一到三倍的提升，但扩大到所有页面和所有游戏时接连出现了几个问题。其中一部分可能是终止语句不适配。

另外 TapTap 不知道什么毛病，不管评论多少条，只要超出 500 页，往后的内容不会显示。想联系一下官方还不让我进群，只好设置成从1星到5星各爬五百页。行得通，说明贵司程序员就是这么写的——五百页以后不样显示……

不让爬就不让爬吧，还能快些出结果。

总之折腾了好几天宣布放弃各种技巧，老老实实单线程爬吧。反正最多也就需要一天，刚好还要抽时间准备笔试面试，在爬虫上花太多时间也不是很划算。

哎非科班渣渣找工作不容易啊……

废话完毕。

`taptap.py` 是单线程的笨爬虫，就是很直白的下载页面+解析，按时间倒序逐页逐条保存，有简单的过滤。超过半年的考虑时效也跳过。

`acceleratedTaptap.py` 是加了异步的，但出现了一点问题暂时不敢用了。Debug 半天宣布暂时放弃……

TapTap 这个社区质量还是很高的，评论总数并不是很多但看得出玩家确实很投入。

最热门的可能也就五六万条评论，加上上面说的读取限制，以及我设置的半年期限和最小长度，一个游戏下载到一万条就很难得了。

测试的时候把 TOP30 爬了一遍，文件加起来还不到 50M……希望足够我下一阶段的实验使用。



以后有时间和精力倒是打算认真学一下爬虫，到时候可能更新吧。